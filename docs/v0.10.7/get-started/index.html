<!doctype html><html lang=en><head><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-84550302-1','auto');ga('send','pageview');</script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=description content="Policy-based control for cloud native environments"><meta property=og:title content="Get started"><meta property=og:type content=documentation><meta property=og:url content=https://openpolicyagent.org/docs/v0.10.7/get-started/><meta property=og:locale content=en_US><meta property=og:site_name content="Open Policy Agent"><meta property=og:description content="Policy-based control for cloud native environments"><meta name=og:type content=article><meta name=og:image content=https://openpolicyagent.org/img/logos/opa-horizontal-color.png><meta name=og:image:alt content="Open Policy Agent project logo"><meta name=og:image:type content=image/png><meta name=twitter:card content=summary><meta name=twitter:site content=@OpenPolicyAgent><meta name=twitter:creator content=@OpenPolicyAgent><link rel=canonical content=https://openpolicyagent.org/docs/v0.10.7/get-started/><link rel="shortcut icon" href=/favicon.png type=image/x-icon><meta name=generator content="Hugo 0.53"><title>Open Policy Agent | Get started</title><link rel=stylesheet href=/css/style.6bbca25e01250b8412df90aabdfbddb4f7b3b892dd593d933cd29794b98a3373.css integrity="sha256-a7yiXgElC4QS35CqvfvdtPezuJLdWT2TPNKXlLmKM3M="></head><body><div class=dashboard><div class="dashboard-panel left has-background-white-bis is-hidden-mobile"><div class="dashboard-panel-header has-text-centered"><div class=dashboard-panel-header-logo><a href=https://openpolicyagent.org><img src=/img/logos/opa-stacked-color.png></a></div><div class="dropdown is-left"><div class=dropdown-trigger><span class="button is-primary"><span><strong>v0.10.7</strong>
<span class="tag latest-tag is-success is-small has-text-weight-bold">latest</span></span></span></div></div></div><div class="dashboard-panel-content is-scrollable"><div class=docs-nav><span class=docs-nav-title>Documentation</span>
<a class=docs-nav-item href=/docs/v0.10.7/>Introduction</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class=docs-nav-item href=/docs/v0.10.7/language-reference/>Language Reference</a>
<a class=docs-nav-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=docs-nav-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=docs-nav-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=docs-nav-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=docs-nav-item href=/docs/v0.10.7/status/>Status</a>
<a class=docs-nav-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=docs-nav-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=docs-nav-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=docs-nav-item href=/docs/v0.10.7/security/>Security</a>
<a class=docs-nav-item href=/docs/v0.10.7/plugins/>Plugins</a>
<a class=docs-nav-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=docs-nav-item href=/docs/v0.10.7/faq/>FAQ</a>
<a class=docs-nav-item href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><hr class=docs-nav-hr><span class=docs-nav-title>Tutorials</span>
<a class="docs-nav-item is-active" href=/docs/v0.10.7/get-started/>Get started</a><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#goals>Goals</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#steps>Steps</a><ul><li><a href=#1-make-sure-you-can-run-the-repl-on-your-machine>1. Make sure you can run the REPL on your machine.</a></li><li><a href=#2-create-a-data-file-and-a-policy-module>2. Create a data file and a policy module.</a></li><li><a href=#3-run-the-repl-with-the-data-file-and-policy-module-as-input>3. Run the REPL with the data file and policy module as input.</a></li><li><a href=#4-import-and-export-documents>4. Import and export documents.</a></li><li><a href=#5-define-a-rule-to-identify-servers-in-violation-of-our-security-policy>5. Define a rule to identify servers in violation of our security policy.</a></li></ul></li></ul></li></ul></nav></div><a class=docs-nav-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=docs-nav-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=docs-nav-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><hr class=docs-nav-hr><span class=docs-nav-title>Guides</span>
<a class=docs-nav-item href=/docs/v0.10.7/guides-identity/>Identity and User Attributes</a>
<a class=docs-nav-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Kubernetes Admission Control</a></div></div></div><div class="dashboard-main is-scrollable"><nav class="navbar is-primary"><div class="navbar-brand is-hidden-tablet"><a class=navbar-item href=https://openpolicyagent.org><img src=/img/logos/opa-icon-white.png></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=mobile-menu><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div class="navbar-menu is-hidden-tablet" id=mobile-menu><div class=navbar-start><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Documentation</span>
<a class=navbar-item href=/docs/v0.10.7/>Introduction</a>
<a class=navbar-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/language-reference/>Language Reference</a>
<a class=navbar-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=navbar-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=navbar-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=navbar-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=navbar-item href=/docs/v0.10.7/status/>Status</a>
<a class=navbar-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=navbar-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=navbar-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=navbar-item href=/docs/v0.10.7/security/>Security</a>
<a class=navbar-item href=/docs/v0.10.7/plugins/>Plugins (Experimental)</a>
<a class=navbar-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=navbar-item href=/docs/v0.10.7/faq/>Frequently Asked Questions</a>
<a class=navbar-item href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Tutorials</span>
<a class=navbar-item href=/docs/v0.10.7/get-started/>Get started</a>
<a class=navbar-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=navbar-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=navbar-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Guides</span>
<a class=navbar-item href=/docs/v0.10.7/guides-identity/>Guides: Identity and User Attributes</a>
<a class=navbar-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Guides: Kubernetes Admission Control</a></div><div class=navbar-end><div class=navbar-item><div class=buttons><a class="button is-primary" href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class="button is-primary" href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class="button is-primary" href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class="button is-primary" href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></div></div><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class=navbar-item href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class=navbar-item href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class=navbar-item href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></nav><article class=article><div class=container><section class=hero><div class=hero-body><p class="title is-size-1 is-size-2-mobile">Get started</p></div></section><section class=section><div class=content><p>The Open Policy Agent (OPA) is an open source, general-purpose policy engine that enables unified, context-aware policy enforcement across the entire stack.</p><p>OPA provides a high-level <strong>declarative language</strong> for authoring policies and
simple APIs to answer policy queries. Using OPA, you can offload policy
decisions from your service such as:</p><ul><li>Should this API call be allowed? E.g., <code>true</code> or <code>false</code>.</li><li>How much quota remains for this user? E.g., <code>1048</code>.</li><li>Which hosts can this container be deployed on? E.g., <code>[&quot;host1&quot;, &quot;host40&quot;, ..., &quot;host329&quot;]</code>.</li><li>What updates must be applied to this resource? E.g., <code>{&quot;labels&quot;: {&quot;team&quot;: &quot;products}}</code>.</li></ul><p>This tutorial shows how to get started with OPA using an interactive shell or <a href=https://en.wikipedia.org/wiki/Read–eval–print_loop>REPL (read-eval-print loop)</a>.</p><h2 id=goals>Goals</h2><p>REPLs are great for learning new languages and running quick experiments. You
can use OPA&rsquo;s REPL to experiment with policies and prototype new ones.</p><p>To introduce the REPL, you will use dummy data and an example policy. In English, the policy can be stated as follows:</p><ul><li>Servers that open an unencrypted HTTP port must not be connected to a public network.</li></ul><p>Inside the REPL, you will define rules that codify the policy stated above.</p><p>Once you finish this tutorial, you will be familiar with:</p><ul><li>Running OPA as an interactive shell/REPL.</li><li>Writing ad-hoc queries in <a href=../how-do-i-write-policies>Rego</a>.</li></ul><h2 id=prerequisites>Prerequisites</h2><p>If this is your first time using OPA, download the latest executable for your system.</p><p>On macOS (64-bit):</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -L -o opa https://github.com/open-policy-agent/opa/releases/download/v0.10.7/opa_darwin_amd64</code></pre></div><p>On Linux (64-bit):</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -L -o opa https://github.com/open-policy-agent/opa/releases/download/v0.10.7/opa_linux_amd64</code></pre></div><blockquote><p>Windows users can obtain the OPA executable from <a href=https://github.com/open-policy-agent/opa/releases>GitHub Releases</a>. The steps below are the same for Windows users except the executable name will be different.</p></blockquote><p>Set permissions on the OPA executable:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>chmod <span style=color:#0000cf;font-weight:700>755</span> ./opa</code></pre></div><h2 id=steps>Steps</h2><h3 id=1-make-sure-you-can-run-the-repl-on-your-machine>1. Make sure you can run the REPL on your machine.</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>./opa run</code></pre></div><p>Without any data, you can experiment with simple expressions to get the hang of it:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87;font-weight:700>true</span>
<span style=color:#204a87;font-weight:700>true</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>14</span>
<span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>14</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;world&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#ce5c00;font-weight:700>[</span>
  <span style=color:#4e9a06>&#34;hello&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;world&#34;</span>
<span style=color:#ce5c00;font-weight:700>]</span></code></pre></div><p>You can also test simple boolean expressions:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87;font-weight:700>true</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>false</span>
<span style=color:#204a87;font-weight:700>false</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>14</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span>
<span style=color:#204a87;font-weight:700>true</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#4e9a06>&#34;hello&#34;</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#4e9a06>&#34;goodbye&#34;</span>
<span style=color:#204a87;font-weight:700>true</span></code></pre></div><p>Most REPLs let you define variables that you can reference later on. OPA allows you to do something similar. For example, you can define a <code>pi</code> constant as follows:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>pi</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>14</span></code></pre></div><p>Once &ldquo;pi&rdquo; is defined, you query for the value and write expressions in terms of it:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>pi</span>
<span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#0000cf;font-weight:700>14</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>pi</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span>
<span style=color:#204a87;font-weight:700>true</span></code></pre></div><p>In addition to running queries, the REPL also lets you define rules:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>items</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;pizza&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;apples&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;bread&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;coffee&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>users</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;bob&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;likes&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>},</span> <span style=color:#4e9a06>&#34;alice&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;likes&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}}</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>likes</span><span style=color:#ce5c00;font-weight:700>[[</span><span style=color:#204a87>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>item</span><span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>index</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>users</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#204a87>name</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>likes</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>item</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>items</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>index</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000;font-weight:700>}</span></code></pre></div><p>The likes rule above defines a set of tuples specifying what each user likes.</p><pre><code>&gt; likes[[&quot;alice&quot;, item]] # what does alice like?
+----------+------------------------+
|   item   | likes[[&quot;alice&quot;, item]] |
+----------+------------------------+
| &quot;apples&quot; | [&quot;alice&quot;,&quot;apples&quot;]     |
| &quot;bread&quot;  | [&quot;alice&quot;,&quot;bread&quot;]      |
| &quot;coffee&quot; | [&quot;alice&quot;,&quot;coffee&quot;]     |
+----------+------------------------+
&gt; likes[[name, &quot;bread&quot;]] # who likes bread?
+---------+------------------------+
|  name   | likes[[name, &quot;bread&quot;]] |
+---------+------------------------+
| &quot;bob&quot;   | [&quot;bob&quot;,&quot;bread&quot;]        |
| &quot;alice&quot; | [&quot;alice&quot;,&quot;bread&quot;]      |
+---------+------------------------+
</code></pre><p>When you enter expressions into the OPA REPL, you are effectively running <em>queries</em>. The REPL output shows the values of variables in the expression that make the query <code>true</code>. If there is no set of variables that would make the query <code>true</code>, the REPL prints <code>undefined</code>. If there are no variables in the query and the query evaluates successfully, then the REPL just prints <code>true</code>.</p><p>Quit out of the REPL by pressing Control-D or typing <code>exit</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#204a87>exit</span>
<span style=color:#000>Exiting</span></code></pre></div><h3 id=2-create-a-data-file-and-a-policy-module>2. Create a data file and a policy module.</h3><p>Let&rsquo;s define a bit of JSON data that will be used in the tutorial:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cat &gt;data.json <span style=color:#4e9a06>&lt;&lt;EOF
</span><span style=color:#4e9a06>{
</span><span style=color:#4e9a06>    &#34;servers&#34;: [
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;s1&#34;, &#34;name&#34;: &#34;app&#34;, &#34;protocols&#34;: [&#34;https&#34;, &#34;ssh&#34;], &#34;ports&#34;: [&#34;p1&#34;, &#34;p2&#34;, &#34;p3&#34;]},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;s2&#34;, &#34;name&#34;: &#34;db&#34;, &#34;protocols&#34;: [&#34;mysql&#34;], &#34;ports&#34;: [&#34;p3&#34;]},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;s3&#34;, &#34;name&#34;: &#34;cache&#34;, &#34;protocols&#34;: [&#34;memcache&#34;], &#34;ports&#34;: [&#34;p3&#34;]},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;s4&#34;, &#34;name&#34;: &#34;dev&#34;, &#34;protocols&#34;: [&#34;http&#34;], &#34;ports&#34;: [&#34;p1&#34;, &#34;p2&#34;]}
</span><span style=color:#4e9a06>    ],
</span><span style=color:#4e9a06>    &#34;networks&#34;: [
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;n1&#34;, &#34;public&#34;: false},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;n2&#34;, &#34;public&#34;: false},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;n3&#34;, &#34;public&#34;: true}
</span><span style=color:#4e9a06>    ],
</span><span style=color:#4e9a06>    &#34;ports&#34;: [
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;p1&#34;, &#34;networks&#34;: [&#34;n1&#34;]},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;p2&#34;, &#34;networks&#34;: [&#34;n3&#34;]},
</span><span style=color:#4e9a06>        {&#34;id&#34;: &#34;p3&#34;, &#34;networks&#34;: [&#34;n2&#34;]}
</span><span style=color:#4e9a06>    ]
</span><span style=color:#4e9a06>}
</span><span style=color:#4e9a06>EOF</span></code></pre></div><p>Also, let&rsquo;s include a rule that defines a set of servers that are attached to public networks:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cat &gt;example.rego <span style=color:#4e9a06>&lt;&lt;EOF
</span><span style=color:#4e9a06>package opa.example
</span><span style=color:#4e9a06>
</span><span style=color:#4e9a06>import data.servers
</span><span style=color:#4e9a06>import data.networks
</span><span style=color:#4e9a06>import data.ports
</span><span style=color:#4e9a06>
</span><span style=color:#4e9a06>public_servers[s] {
</span><span style=color:#4e9a06>    s := servers[_]
</span><span style=color:#4e9a06>    s.ports[_] == ports[i].id
</span><span style=color:#4e9a06>    ports[i].networks[_] == networks[j].id
</span><span style=color:#4e9a06>    networks[j].public == true
</span><span style=color:#4e9a06>}
</span><span style=color:#4e9a06>EOF</span></code></pre></div><h3 id=3-run-the-repl-with-the-data-file-and-policy-module-as-input>3. Run the REPL with the data file and policy module as input.</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>./opa run data.json example.rego</code></pre></div><p>You can now run queries against the various documents:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>id</span>
<span style=color:#ce5c00;font-weight:700>+--------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>id</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+--------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s1&#34;</span>               <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s2&#34;</span>               <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s3&#34;</span>               <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s4&#34;</span>               <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+--------------------+</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>opa</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>example</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>public_servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span>                                       <span style=color:#000>x</span>                                       <span style=color:#ce5c00;font-weight:700>|</span>                      <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>opa</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>example</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>public_servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>]</span>                       <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;app&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p3&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;https&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ssh&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;app&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p3&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;https&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ssh&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s4&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;dev&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span>             <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s4&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;dev&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span>             <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+</span></code></pre></div><p>One powerful thing about Rego and the REPL is that you can run queries using the same syntax that you would use to lookup values.</p><p>For example if <code>i</code> has value <code>0</code> then <code>data.servers[i]</code> returns the first value in the <code>data.servers</code> array:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>i</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;s1&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;app&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>[</span>
      <span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;p3&#34;</span>
  <span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#ce5c00;font-weight:700>[</span>
      <span style=color:#4e9a06>&#34;https&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;ssh&#34;</span>
  <span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#000;font-weight:700>}</span></code></pre></div><p>That same expression <code>data.servers[i]</code> when <code>i</code> has no value defines a query that returns all the values of <code>i</code> and <code>data.servers[i]</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>unset</span> <span style=color:#000>i</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#ce5c00;font-weight:700>+---+-------------------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>|</span>                                <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>                                <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+---+-------------------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;app&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p3&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;https&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ssh&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>1</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s2&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;db&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p3&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;mysql&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span>                  <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>2</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s3&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;cache&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p3&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;memcache&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span>            <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s4&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;dev&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span>             <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+---+-------------------------------------------------------------------------------+</span></code></pre></div><h3 id=4-import-and-export-documents>4. Import and export documents.</h3><p>The REPL also understands the <a href=../how-do-i-write-policies#modules>Import and Package</a> directives.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>import</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>ports</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87>id</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>id</span>
<span style=color:#ce5c00;font-weight:700>+---+------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>|</span>  <span style=color:#204a87>id</span>  <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+---+------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s1&#34;</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#0000cf;font-weight:700>3</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#4e9a06>&#34;s4&#34;</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+---+------+</span></code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>package</span> <span style=color:#000>opa</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>example</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>public_servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>protocols</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;http&#34;</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span>                                 <span style=color:#000>x</span>                                 <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s4&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;dev&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span></code></pre></div><h3 id=5-define-a-rule-to-identify-servers-in-violation-of-our-security-policy>5. Define a rule to identify servers in violation of our security policy.</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>import</span> <span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>servers</span>
<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>violations</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>s</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span>
  <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>protocols</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;http&#34;</span>
  <span style=color:#000>public_servers</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>violations</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>server</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>_</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span>                              <span style=color:#000>server</span>                               <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span>
<span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#4e9a06>:&#34;s4&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#4e9a06>:&#34;dev&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;ports&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;p1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;p2&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;protocols&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;http&#34;</span><span style=color:#ce5c00;font-weight:700>]</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>|</span>
<span style=color:#ce5c00;font-weight:700>+-------------------------------------------------------------------+</span></code></pre></div><blockquote><p>The REPL accepts multi-line input and will change appearance when it
detects multi-line input. You can end multi-line input by inserting
a blank line.</p></blockquote></div></section></div></article></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js></script><script src=/js/app.145c7a3bc61d0b561cc282851776ffdcd33e6b35aebca1b05449aa9195eaf751.js integrity="sha256-FFx6O8YdC1YcwoKFF3b/3NM&#43;azWuvKGwVEmqkZXq91E="></script></body></html>