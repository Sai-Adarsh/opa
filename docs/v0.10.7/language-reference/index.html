<!doctype html><html lang=en><head><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-84550302-1','auto');ga('send','pageview');</script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=description content="Policy-based control for cloud native environments"><meta property=og:title content="Language Reference"><meta property=og:type content=documentation><meta property=og:url content=https://openpolicyagent.org/docs/v0.10.7/language-reference/><meta property=og:locale content=en_US><meta property=og:site_name content="Open Policy Agent"><meta property=og:description content="Policy-based control for cloud native environments"><meta name=og:type content=article><meta name=og:image content=https://openpolicyagent.org/img/logos/opa-horizontal-color.png><meta name=og:image:alt content="Open Policy Agent project logo"><meta name=og:image:type content=image/png><meta name=twitter:card content=summary><meta name=twitter:site content=@OpenPolicyAgent><meta name=twitter:creator content=@OpenPolicyAgent><link rel=canonical content=https://openpolicyagent.org/docs/v0.10.7/language-reference/><link rel="shortcut icon" href=/favicon.png type=image/x-icon><meta name=generator content="Hugo 0.53"><title>Open Policy Agent | Language Reference</title><link rel=stylesheet href=/css/style.6bbca25e01250b8412df90aabdfbddb4f7b3b892dd593d933cd29794b98a3373.css integrity="sha256-a7yiXgElC4QS35CqvfvdtPezuJLdWT2TPNKXlLmKM3M="></head><body><div class=dashboard><div class="dashboard-panel left has-background-white-bis is-hidden-mobile"><div class="dashboard-panel-header has-text-centered"><div class=dashboard-panel-header-logo><a href=https://openpolicyagent.org><img src=/img/logos/opa-stacked-color.png></a></div><div class="dropdown is-left"><div class=dropdown-trigger><span class="button is-primary"><span><strong>v0.10.7</strong>
<span class="tag latest-tag is-success is-small has-text-weight-bold">latest</span></span></span></div></div></div><div class="dashboard-panel-content is-scrollable"><div class=docs-nav><span class=docs-nav-title>Documentation</span>
<a class=docs-nav-item href=/docs/v0.10.7/>Introduction</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class="docs-nav-item is-active" href=/docs/v0.10.7/language-reference/>Language Reference</a><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#built-in-functions>Built-in Functions</a><ul><li><a href=#comparison>Comparison</a></li><li><a href=#numbers>Numbers</a></li><li><a href=#aggregates>Aggregates</a></li><li><a href=#arrays>Arrays</a></li><li><a href=#sets>Sets</a></li><li><a href=#strings>Strings</a></li><li><a href=#regex>Regex</a></li><li><a href=#glob>Glob</a></li><li><a href=#types>Types</a></li><li><a href=#encoding>Encoding</a></li><li><a href=#tokens>Tokens</a></li><li><a href=#time>Time</a></li><li><a href=#cryptography>Cryptography</a></li><li><a href=#graphs>Graphs</a></li><li><a href=#http>HTTP</a><ul><li><a href=#https-usage>HTTPs Usage</a></li><li><a href=#https-examples>HTTPs Examples</a></li></ul></li><li><a href=#net>Net</a></li><li><a href=#rego>Rego</a></li><li><a href=#opa>OPA</a></li><li><a href=#debugging>Debugging</a></li></ul></li><li><a href=#reserved-names>Reserved Names</a></li><li><a href=#grammar>Grammar</a></li></ul></li></ul></nav></div><a class=docs-nav-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=docs-nav-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=docs-nav-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=docs-nav-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=docs-nav-item href=/docs/v0.10.7/status/>Status</a>
<a class=docs-nav-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=docs-nav-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=docs-nav-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=docs-nav-item href=/docs/v0.10.7/security/>Security</a>
<a class=docs-nav-item href=/docs/v0.10.7/plugins/>Plugins</a>
<a class=docs-nav-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=docs-nav-item href=/docs/v0.10.7/faq/>FAQ</a>
<a class=docs-nav-item href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><hr class=docs-nav-hr><span class=docs-nav-title>Tutorials</span>
<a class=docs-nav-item href=/docs/v0.10.7/get-started/>Get started</a>
<a class=docs-nav-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=docs-nav-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=docs-nav-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><hr class=docs-nav-hr><span class=docs-nav-title>Guides</span>
<a class=docs-nav-item href=/docs/v0.10.7/guides-identity/>Identity and User Attributes</a>
<a class=docs-nav-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Kubernetes Admission Control</a></div></div></div><div class="dashboard-main is-scrollable"><nav class="navbar is-primary"><div class="navbar-brand is-hidden-tablet"><a class=navbar-item href=https://openpolicyagent.org><img src=/img/logos/opa-icon-white.png></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=mobile-menu><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div class="navbar-menu is-hidden-tablet" id=mobile-menu><div class=navbar-start><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Documentation</span>
<a class=navbar-item href=/docs/v0.10.7/>Introduction</a>
<a class=navbar-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/language-reference/>Language Reference</a>
<a class=navbar-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=navbar-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=navbar-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=navbar-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=navbar-item href=/docs/v0.10.7/status/>Status</a>
<a class=navbar-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=navbar-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=navbar-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=navbar-item href=/docs/v0.10.7/security/>Security</a>
<a class=navbar-item href=/docs/v0.10.7/plugins/>Plugins (Experimental)</a>
<a class=navbar-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=navbar-item href=/docs/v0.10.7/faq/>Frequently Asked Questions</a>
<a class=navbar-item href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Tutorials</span>
<a class=navbar-item href=/docs/v0.10.7/get-started/>Get started</a>
<a class=navbar-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=navbar-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=navbar-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Guides</span>
<a class=navbar-item href=/docs/v0.10.7/guides-identity/>Guides: Identity and User Attributes</a>
<a class=navbar-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Guides: Kubernetes Admission Control</a></div><div class=navbar-end><div class=navbar-item><div class=buttons><a class="button is-primary" href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class="button is-primary" href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class="button is-primary" href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class="button is-primary" href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></div></div><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class=navbar-item href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class=navbar-item href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class=navbar-item href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></nav><article class=article><div class=container><section class=hero><div class=hero-body><p class="title is-size-1 is-size-2-mobile">Language Reference</p></div></section><section class=section><div class=content><p>This document is the authoritative specification of the Rego policy language
(V1). All policies in OPA are written in Rego.</p><h2 id=built-in-functions>Built-in Functions</h2><p>The built-in functions for the language provide basic operations to manipulate
scalar values (e.g. numbers and strings), and aggregate functions that summarize
complex types.</p><h3 id=comparison>Comparison</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>x == y</code></span></td><td><code>x</code> is equal to <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>x != y</code></span></td><td><code>x</code> is not equal to <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>x &lt; y</code></span></td><td><code>x</code> is less than <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>x &lt;= y</code></span></td><td><code>x</code> is less than or equal to <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>x &gt; y</code></span></td><td><code>x</code> is greater than <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>x &gt;= y</code></span></td><td><code>x</code> is greater than or equal to <code>y</code></td></tr></tbody></table><h3 id=numbers>Numbers</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>z := x + y</code></span></td><td><code>z</code> is the sum of <code>x</code> and <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>z := x - y</code></span></td><td><code>z</code> is the difference of <code>x</code> and <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>z := x * y</code></span></td><td><code>z</code> is the product of <code>x</code> and <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>z := x / y</code></span></td><td><code>z</code> is the quotient of <code>x</code> and <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>z := x % y</code></span></td><td><code>z</code> is the remainder from the division of <code>x</code> and <code>y</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := round(x)</code></span></td><td><code>output</code> is <code>x</code> rounded to the nearest integer</td></tr><tr><td><span class=opa-keep-it-together><code>output := abs(x)</code></span></td><td><code>output</code> is the absolute value of <code>x</code></td></tr></tbody></table><h3 id=aggregates>Aggregates</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := count(collection_or_string)</code></span></td><td><code>output</code> is the length of the object, array, set, or string provided as input</td></tr><tr><td><span class=opa-keep-it-together><code>output := sum(array_or_set)</code></span></td><td><code>output</code> is the sum of the numbers in <code>array_or_set</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := product(array_or_set)</code></span></td><td><code>output</code> is the product of the numbers in <code>array_or_set</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := max(array_or_set)</code></span></td><td><code>output</code> is the maximum value in <code>array_or_set</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := min(array_or_set)</code></span></td><td><code>output</code> is the minimum value in <code>array_or_set</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := sort(array_or_set)</code></span></td><td><code>output</code> is the sorted <code>array</code> containing elements from <code>array_or_set</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := all(array_or_set)</code></span></td><td><code>output</code> is <code>true</code> if all of the values in <code>array_or_set</code> are <code>true</code>. A collection of length 0 returns <code>true</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := any(array_or_set)</code></span></td><td><code>output</code> is <code>true</code> if any of the values in <code>array_or_set</code> is <code>true</code>. A collection of length 0 returns <code>false</code>.</td></tr></tbody></table><h3 id=arrays>Arrays</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := array.concat(array, array)</code></span></td><td><code>output</code> is the result of concatenating the two input arrays together.</td></tr><tr><td><span class=opa-keep-it-together><code>output := array.slice(array, startIndex, stopIndex)</code></span></td><td><code>output</code> is the part of the <code>array</code> from <code>startIndex</code> to <code>stopIndex</code> including the first but excluding the last. If <code>startIndex &lt; stopIndex</code> then <code>output == []</code>. If both <code>startIndex</code> and <code>stopIndex</code> are less than zero, <code>output == []</code>. Otherwise, <code>startIndex</code> and <code>stopIndex</code> are clamped to 0 and <code>count(array)</code> respectively.</td></tr></tbody></table><h3 id=sets>Sets</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>s3 := s1 &amp; s2</code></span></td><td><code>s3</code> is the intersection of <code>s1</code> and <code>s2</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>s3 := s1 &#124; s2</code></span></td><td><code>s3</code> is the union of <code>s1</code> and <code>s2</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>s3 := s1 - s2</code></span></td><td><code>s3</code> is the difference between <code>s1</code> and <code>s2</code>, i.e., the elements in <code>s1</code> that are not in <code>s2</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := intersection(set[set])</code></span></td><td><code>output</code> is the intersection of the sets in the input set</td></tr><tr><td><span class=opa-keep-it-together><code>output := union(set[set])</code></span></td><td><code>output</code> is the union of the sets in the input set</td></tr></tbody></table><h3 id=strings>Strings</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := concat(delimiter, array_or_set)</code></span></td><td><code>output</code> is the result of joining together the elements of <code>array_or_set</code> with the string <code>delimiter</code></td></tr><tr><td><span class=opa-keep-it-together><code>contains(string, search)</code></span></td><td>true if <code>string</code> contains <code>search</code></td></tr><tr><td><span class=opa-keep-it-together><code>endswith(string, search)</code></span></td><td>true if <code>string</code> ends with <code>search</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := format_int(number, base)</code></span></td><td><code>output</code> is string representation of <code>number</code> in the given <code>base</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := indexof(string, search)</code></span></td><td><code>output</code> is the index inside <code>string</code> where <code>search</code> first occurs, or -1 if <code>search</code> does not exist</td></tr><tr><td><span class=opa-keep-it-together><code>output := lower(string)</code></span></td><td><code>output</code> is <code>string</code> after converting to lower case</td></tr><tr><td><span class=opa-keep-it-together><code>output := replace(string, old, new)</code></span></td><td><code>output</code> is a <code>string</code> representing <code>string</code> with all instances of <code>old</code> replaced by <code>new</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := split(string, delimiter)</code></span></td><td><code>output</code> is <code>array[string]</code> representing elements of <code>string</code> separated by <code>delimiter</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := sprintf(string, values)</code></span></td><td><code>output</code> is a <code>string</code> representing <code>string</code> formatted by the values in the <code>array</code> <code>values</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>startswith(string, search)</code></span></td><td>true if <code>string</code> begins with <code>search</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := substring(string, start, length)</code></span></td><td><code>output</code> is the portion of <code>string</code> from index <code>start</code> and having a length of <code>length</code>. If <code>length</code> is less than zero, <code>length</code> is the remainder of the <code>string</code>. If <code>start</code> is greater than the length of the string, <code>output</code> is empty. It is invalid to pass a negative offset to this function.</td></tr><tr><td><span class=opa-keep-it-together><code>output := trim(string, cutset)</code></span></td><td><code>output</code> is a <code>string</code> representing <code>string</code> with all leading and trailing instances of the characters in <code>cutset</code> removed.</td></tr><tr><td><span class=opa-keep-it-together><code>output := upper(string)</code></span></td><td><code>output</code> is <code>string</code> after converting to upper case</td></tr></tbody></table><h3 id=regex>Regex</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>re_match(pattern, value)</code></span></td><td>true if the <code>value</code> matches the regex <code>pattern</code></td></tr><tr><td><span class=opa-keep-it-together><code>output := regex.split(pattern, string)</code></span></td><td><code>output</code> is <code>array[string]</code> representing elements of <code>string</code> separated by <code>pattern</code></td></tr><tr><td><span class=opa-keep-it-together><code>regex.globs_match(glob1, glob2)</code></span></td><td>true if the intersection of regex-style globs <code>glob1</code> and <code>glob2</code> matches a non-empty set of non-empty strings. The set of regex symbols is limited for this builtin: only <code>.</code>, <code>*</code>, <code>+</code>, <code>[</code>, <code>-</code>, <code>]</code> and <code>\</code> are treated as special symbols.</td></tr><tr><td><span class=opa-keep-it-normal><code>output := regex.template_match(patter, string, delimiter_start, delimiter_end)</code></span></td><td><code>output</code> is true if <code>string</code> matches <code>pattern</code>. <code>pattern</code> is a string containing <code>0..n</code> regular expressions delimited by <code>delimiter_start</code> and <code>delimiter_end</code>. Example <code>regex.template_match(&quot;urn:foo:{.*}&quot;, &quot;urn:foo:bar:baz&quot;, &quot;{&quot;, &quot;}&quot;, x)</code> returns <code>true</code> for <code>x</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := regex.find_n(pattern, string, number)</code></span></td><td><code>output</code> is an <code>array[string]</code> with the <code>number</code> of values matching the <code>pattern</code>. A <code>number</code> of <code>-1</code> means all matches.</td></tr></tbody></table><h3 id=glob>Glob</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := glob.match(pattern, delimiters, match)</code></span></td><td><code>output</code> is true if <code>match</code> can be found in <code>pattern</code> which is separated by <code>delimiters</code>. For valid patterns, check the table below. Argument <code>delimiters</code> is an array of single-characters (e.g. <code>[&quot;.&quot;, &quot;:&quot;]</code>). If <code>delimiters</code> is empty, it defaults to <code>[&quot;.&quot;]</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := glob.quote_meta(pattern)</code></span></td><td><code>output</code> is the escaped string of <code>pattern</code>. Calling <code>glob.quote_meta(&quot;*.github.com&quot;, output)</code> returns <code>\\*.github.com</code> as <code>output</code>.</td></tr></tbody></table><p>The following table shows examples of how <code>glob.match</code> works:</p><table><thead><tr><th><code>call</code></th><th><code>output</code></th><th>Description</th></tr></thead><tbody><tr><td><code>output := glob.match(&quot;*.github.com&quot;, [], &quot;api.github.com&quot;)</code></td><td><code>true</code></td><td>A glob with the default <code>[&quot;.&quot;]</code> delimiter.</td></tr><tr><td><code>output := glob.match(&quot;*:github:com&quot;, [&quot;:&quot;], &quot;api:github:com&quot;)</code></td><td><code>true</code></td><td>A glob with delimiters <code>[&quot;:&quot;]</code>.</td></tr><tr><td><code>output := glob.match(&quot;api.**.com&quot;, [], &quot;api.github.com&quot;)</code></td><td><code>true</code></td><td>A super glob.</td></tr><tr><td><code>output := glob.match(&quot;api.**.com&quot;, [], &quot;api.cdn.github.com&quot;)</code></td><td><code>true</code></td><td>A super glob.</td></tr><tr><td><code>output := glob.match(&quot;?at&quot;, [], &quot;cat&quot;)</code></td><td><code>true</code></td><td>A glob with a single character wildcard.</td></tr><tr><td><code>output := glob.match(&quot;?at&quot;, [], &quot;at&quot;)</code></td><td><code>false</code></td><td>A glob with a single character wildcard.</td></tr><tr><td><code>output := glob.match(&quot;[abc]at&quot;, [], &quot;bat&quot;)</code></td><td><code>true</code></td><td>A glob with character-list matchers.</td></tr><tr><td><code>output := glob.match(&quot;[abc]at&quot;, [], &quot;cat&quot;)</code></td><td><code>true</code></td><td>A glob with character-list matchers.</td></tr><tr><td><code>output := glob.match(&quot;[abc]at&quot;, [], &quot;lat&quot;)</code></td><td><code>false</code></td><td>A glob with character-list matchers.</td></tr><tr><td><code>output := glob.match(&quot;[!abc]at&quot;, [], &quot;cat&quot;)</code></td><td><code>false</code></td><td>A glob with negated character-list matchers.</td></tr><tr><td><code>output := glob.match(&quot;[!abc]at&quot;, [], &quot;lat&quot;)</code></td><td><code>true</code></td><td>A glob with negated character-list matchers.</td></tr><tr><td><code>output := glob.match(&quot;[a-c]at&quot;, [], &quot;cat&quot;)</code></td><td><code>true</code></td><td>A glob with character-range matchers.</td></tr><tr><td><code>output := glob.match(&quot;[a-c]at&quot;, [], &quot;lat&quot;)</code></td><td><code>false</code></td><td>A glob with character-range matchers.</td></tr><tr><td><code>output := glob.match(&quot;[!a-c]at&quot;, [], &quot;cat&quot;)</code></td><td><code>false</code></td><td>A glob with negated character-range matchers.</td></tr><tr><td><code>output := glob.match(&quot;[!a-c]at&quot;, [], &quot;lat&quot;)</code></td><td><code>true</code></td><td>A glob with negated character-range matchers.</td></tr><tr><td><code>output := glob.match(&quot;&quot;{cat,bat,[fr]at}&quot;, [], &quot;cat&quot;)</code></td><td><code>true</code></td><td>A glob with pattern-alternatives matchers.</td></tr><tr><td><code>output := glob.match(&quot;&quot;{cat,bat,[fr]at}&quot;, [], &quot;bat&quot;)</code></td><td><code>true</code></td><td>A glob with pattern-alternatives matchers.</td></tr><tr><td><code>output := glob.match(&quot;&quot;{cat,bat,[fr]at}&quot;, [], &quot;rat&quot;)</code></td><td><code>true</code></td><td>A glob with pattern-alternatives matchers.</td></tr><tr><td><code>output := glob.match(&quot;&quot;{cat,bat,[fr]at}&quot;, [], &quot;at&quot;)</code></td><td><code>false</code></td><td>A glob with pattern-alternatives matchers.</td></tr></tbody></table><h3 id=types>Types</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := to_number(x)</code></span></td><td><code>output</code> is <code>x</code> converted to a number</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_number(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is a number</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_string(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is a string</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_string(x)</code></span></td><td><code>output</code> is <code>x</code> cast to a string</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_boolean(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is a boolean</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_boolean(x)</code></span></td><td><code>output</code> is <code>x</code> cast to a boolean</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_array(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is an array</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_array(x)</code></span></td><td><code>output</code> is <code>x</code> cast to an array</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_set(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is a set</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_set(x)</code></span></td><td><code>output</code> is <code>x</code> cast to a set</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_object(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is an object</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_object(x)</code></span></td><td><code>output</code> is <code>x</code> cast to an object</td></tr><tr><td><span class=opa-keep-it-together><code>output := is_null(x)</code></span></td><td><code>output</code> is <code>true</code> if <code>x</code> is null</td></tr><tr><td><span class=opa-keep-it-together><code>output := cast_null(x)</code></span></td><td><code>output</code> is <code>x</code> cast to null</td></tr><tr><td><span class=opa-keep-it-together><code>output := type_name(x)</code></span></td><td><code>output</code> is the type of <code>x</code></td></tr></tbody></table><h3 id=encoding>Encoding</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := base64.encode(x)</code></span></td><td><code>output</code> is <code>x</code> serialized to a base64 encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := base64.decode(string)</code></span></td><td><code>output</code> is <code>x</code> deserialized from a base64 encoding string</td></tr><tr><td><span class=opa-keep-it-together><code>output := base64url.encode(x)</code></span></td><td><code>output</code> is <code>x</code> serialized to a base64url encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := base64url.decode(string)</code></span></td><td><code>output</code> is <code>string</code> deserialized from a base64url encoding string</td></tr><tr><td><span class=opa-keep-it-together><code>output := urlquery.encode(string)</code></span></td><td><code>output</code> is <code>string</code> serialized to a URL query parameter encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := urlquery.encode_object(object)</code></span></td><td><code>output</code> is <code>object</code> serialized to a URL query parameter encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := urlquery.decode(string)</code></span></td><td><code>output</code> is <code>string</code> deserialized from a URL query parameter encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := json.marshal(x)</code></span></td><td><code>output</code> is <code>x</code> serialized to a JSON string</td></tr><tr><td><span class=opa-keep-it-together><code>output := json.unmarshal(string)</code></span></td><td><code>output</code> is <code>string</code> deserialized to a term from a JSON encoded string</td></tr><tr><td><span class=opa-keep-it-together><code>output := yaml.marshal(x)</code></span></td><td><code>output</code> is <code>x</code> serialized to a YAML string</td></tr><tr><td><span class=opa-keep-it-together><code>output := yaml.unmarshal(string)</code></span></td><td><code>output</code> is <code>string</code> deserialized to a term from YAML encoded string</td></tr></tbody></table><h3 id=tokens>Tokens</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := io.jwt.verify_rs256(string, certificate)</code></span></td><td><code>output</code> is <code>true</code> if the RS256 signature of the input token is valid. <code>certificate</code> is the PEM encoded certificate used to verify the RS256 signature</td></tr><tr><td><span class=opa-keep-it-together><code>output := io.jwt.verify_ps256(string, certificate)</code></span></td><td><code>output</code> is <code>true</code> if the PS256 signature of the input token is valid. <code>certificate</code> is the PEM encoded certificate used to verify the PS256 signature</td></tr><tr><td><span class=opa-keep-it-together><code>output := io.jwt.verify_es256(string, certificate)</code></span></td><td><code>output</code> is <code>true</code> if the ES256 signature of the input token is valid. <code>certificate</code> is the PEM encoded certificate used to verify the ES256 signature</td></tr><tr><td><span class=opa-keep-it-together><code>output := io.jwt.verify_hs256(string, secret)</code></span></td><td><code>output</code> is <code>true</code> if the Secret signature of the input token is valid. <code>secret</code> is a plain text secret used to verify the HS256 signature</td></tr><tr><td><span class=opa-keep-it-together><code>output := io.jwt.decode(string)</code></span></td><td><code>output</code> is of the form <code>[header, payload, sig]</code>. <code>header</code> and <code>payload</code> are <code>object</code>. <code>sig</code> is the hexadecimal representation of the signature on the token.</td></tr><tr><td><span class=opa-keep-it-together><code>output := io.jwt.decode_verify(string, constraints)</code></span></td><td><code>output</code> is of the form <code>[valid, header, payload]</code>. If the input token verifies and meets the requirements of <code>constraints</code> then <code>valid</code> is <code>true</code> and <code>header</code> and <code>payload</code> are objects containing the JOSE header and the JWT claim set. Otherwise, <code>valid</code> is <code>false</code> and <code>header</code> and <code>payload</code> are <code>{}</code>.</td></tr></tbody></table><p>The input <code>string</code> is a JSON Web Token encoded with JWS Compact Serialization. JWE and JWS JSON Serialization are not supported. If nested signing was used, the <code>header</code>, <code>payload</code> and <code>signature</code> will represent the most deeply nested token.</p><p>For <code>io.jwt.decode_verify</code>, <code>constraints</code> is an object with the following members:</p><table><thead><tr><th>Name</th><th>Meaning</th><th>Required</th></tr></thead><tbody><tr><td><code>cert</code></td><td>A PEM encoded certificate containing an RSA or ECDSA public key.</td><td>See below</td></tr><tr><td><code>secret</code></td><td>The secret key for HS256, HS384 and HS512 verification.</td><td>See below</td></tr><tr><td><code>alg</code></td><td>The JWA algorithm name to use. If it is absent then any algorithm that is compatible with the key is accepted.</td><td>Optional</td></tr><tr><td><code>iss</code></td><td>The issuer string. If it is present the only tokens with this issuer are accepted. If it is absent then any issuer is accepted.</td><td>Optional</td></tr><tr><td><code>time</code></td><td>The time in nanoseconds to verify the token at. If this is present then the <code>exp</code> and <code>nbf</code> claims are compared against this value. If it is absent then they are compared against the current time.</td><td>Optional</td></tr><tr><td><code>aud</code></td><td>The audience that the verifier identifies with. If this is present then the <code>aud</code> claim is checked against it. If it is absent then the <code>aud</code> claim must be absent too.</td><td>Optional</td></tr></tbody></table><p>Exactly one of <code>cert</code> and <code>secret</code> must be present.
If there are any unrecognized constraints then the token is considered invalid.</p><h3 id=time>Time</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := time.now_ns()</code></span></td><td><code>output</code> is <code>number</code> representing the current time since epoch in nanoseconds.</td></tr><tr><td><span class=opa-keep-it-together><code>output := time.parse_ns(layout, value)</code></span></td><td><code>output</code> is <code>number</code> representing the time <code>value</code> in nanoseconds since epoch. See the <a href=https://golang.org/pkg/time/#Parse>Go <code>time</code> package documentation</a> for more details on <code>layout</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := time.parse_rfc3339_ns(value)</code></span></td><td><code>output</code> is <code>number</code> representing the time <code>value</code> in nanoseconds since epoch.</td></tr><tr><td><span class=opa-keep-it-together><code>output := time.parse_duration_ns(duration)</code></span></td><td><code>output</code> is <code>number</code> representing the duration <code>duration</code> in nanoseconds. See the <a href=https://golang.org/pkg/time/#ParseDuration>Go <code>time</code> package documentation</a> for more details on <code>duration</code>.</td></tr><tr><td><span class=opa-keep-it-together><code>output := time.date(ns)</code></span></td><td><code>output</code> is of the form <code>[year, month, day]</code>, which includes the <code>year</code>, <code>month</code> (0-12), and <code>day</code> (0-31) as <code>number</code>s representing the date from the nanoseconds since epoch (<code>ns</code>).</td></tr><tr><td><span class=opa-keep-it-together><code>output := time.clock(ns)</code></span></td><td><code>output</code> is of the form <code>[hour, minute, second]</code>, which outputs the <code>hour</code>, <code>minute</code> (0-59), and <code>second</code> (0-59) as <code>number</code>s representing the time of day for the nanoseconds since epoch (<code>ns</code>).</td></tr><tr><td><span class=opa-keep-it-together><code>day := time.weekday(ns)</code></span></td><td>outputs the <code>day</code> as <code>string</code> representing the day of the week for the nanoseconds since epoch (<code>ns</code>).</td></tr></tbody></table><blockquote><p>Multiple calls to the <code>time.now_ns</code> built-in function within a single policy
evaluation query will always return the same value.</p></blockquote><h3 id=cryptography>Cryptography</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := crypto.x509.parse_certificates(string)</code></span></td><td><code>output</code> is an array of X.509 certificates represented as JSON objects.</td></tr></tbody></table><h3 id=graphs>Graphs</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>walk(x, [path, value])</code></span></td><td><code>walk</code> is a relation that produces <code>path</code> and <code>value</code> pairs for documents under <code>x</code>. <code>path</code> is <code>array</code> representing a pointer to <code>value</code> in <code>x</code>. Queries can use <code>walk</code> to traverse documents nested under <code>x</code> (recursively).</td></tr></tbody></table><h3 id=http>HTTP</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>http.send(request, output)</code></span></td><td><code>http.send</code> executes a HTTP request and returns the response.<code>request</code> is an object containing keys <code>method</code>, <code>url</code> and optionally <code>body</code>, <code>enable_redirect</code>, <code>force_json_decode</code>, <code>headers</code>, <code>tls_use_system_certs</code>, <code>tls_ca_cert_file</code>, <code>tls_ca_cert_env_variable</code>, <code>tls_client_cert_env_variable</code>, <code>tls_client_key_env_variable</code> or <code>tls_client_cert_file</code>, <code>tls_client_key_file</code> . For example, <code>http.send({&quot;method&quot;: &quot;get&quot;, &quot;url&quot;: &quot;http://www.openpolicyagent.org/&quot;, &quot;headers&quot;: {&quot;X-Foo&quot;:&quot;bar&quot;, &quot;X-Opa&quot;: &quot;rules&quot;}}, output)</code>. <code>output</code> is an object containing keys <code>status</code>, <code>status_code</code>, <code>body</code> and <code>raw_body</code> which represent the HTTP status, status code, JSON value from the response body and response body as string respectively. Sample output, <code>{&quot;status&quot;: &quot;200 OK&quot;, &quot;status_code&quot;: 200, &quot;body&quot;: {&quot;hello&quot;: &quot;world&quot;}, &quot;raw_body&quot;: &quot;{\&quot;hello\&quot;: \&quot;world\&quot;}&quot;</code>}. By default, HTTP redirects are not enabled. To enable, set <code>enable_redirect</code> to <code>true</code>. Also <code>force_json_decode</code> is set to <code>false</code> by default. This means if the HTTP server response does not specify the <code>Content-type</code> as <code>application/json</code>, the response body will not be JSON decoded ie. output&rsquo;s <code>body</code> field will be <code>null</code>. To change this behaviour, set <code>force_json_decode</code> to <code>true</code>.</td></tr></tbody></table><h4 id=https-usage>HTTPs Usage</h4><p>The following table explains the HTTPs objects</p><table><thead><tr><th>Object</th><th>Definition</th><th>Value</th></tr></thead><tbody><tr><td>tls_use_system_certs</td><td>Use system certificate pool</td><td>true or false</td></tr><tr><td>tls_ca_cert_file</td><td>Path to file containing a root certificate in PEM encoded format</td><td>double-quoted string</td></tr><tr><td>tls_ca_cert_env_variable</td><td>Environment variable containing a root certificate in PEM encoded format</td><td>double-quoted string</td></tr><tr><td>tls_client_cert_env_variable</td><td>Environment variable containing a client certificate in PEM encoded format</td><td>double-quoted string</td></tr><tr><td>tls_client_key_env_variable</td><td>Environment variable containing a client key in PEM encoded format</td><td>double-quoted string</td></tr><tr><td>tls_client_cert_file</td><td>Path to file containing a client certificate in PEM encoded format</td><td>double-quoted string</td></tr><tr><td>tls_client_key_file</td><td>Path to file containing a key in PEM encoded format</td><td>double-quoted string</td></tr></tbody></table><p>In order to trigger the use of HTTPs the user must provide one of the following combinations:</p><ul><li><code>tls_client_cert_file</code>, <code>tls_client_key_file</code></li><li><code>tls_client_cert_env_variable</code>, <code>tls_client_key_env_variable</code></li></ul><p>The user must also provide a trusted root CA through tls_ca_cert_file or tls_ca_cert_env_variable. Alternatively the user could set tls_use_system_certs to <code>true</code> and the system certificate pool will be used.</p><h4 id=https-examples>HTTPs Examples</h4><table><thead><tr><th>Examples</th><th>Comments</th></tr></thead><tbody><tr><td>Files containing TLS material</td><td><code>http.send({&quot;method&quot;: &quot;get&quot;, &quot;url&quot;: &quot;https://127.0.0.1:65331&quot;, &quot;tls_ca_cert_file&quot;: &quot;testdata/ca.pem&quot;, &quot;tls_client_cert_file&quot;: &quot;testdata/client-cert.pem&quot;, &quot;tls_client_key_file&quot;: &quot;testdata/client-key.pem&quot;}, output)</code>.</td></tr><tr><td>Environment variables containing TLS material</td><td><code>http.send({&quot;method&quot;: &quot;get&quot;, &quot;url&quot;: &quot;https://127.0.0.1:65360&quot;, &quot;tls_ca_cert_env_variable&quot;: &quot;CLIENT_CA_ENV&quot;, &quot;tls_client_cert_env_variable&quot;: &quot;CLIENT_CERT_ENV&quot;, &quot;tls_client_key_env_variable&quot;: &quot;CLIENT_KEY_ENV&quot;}, output)</code>.</td></tr><tr><td>Accessing Google using System Cert Pool</td><td><code>http.send({&quot;method&quot;: &quot;get&quot;, &quot;url&quot;: &quot;https://www.google.com&quot;, &quot;tls_use_system_certs&quot;: true, &quot;tls_client_cert_file&quot;: &quot;testdata/client-cert.pem&quot;, &quot;tls_client_key_file&quot;: &quot;testdata/client-key.pem&quot;}, output)</code></td></tr></tbody></table><h3 id=net>Net</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>net.cidr_contains(cidr, cidr_or_ip)</code></span></td><td><code>output</code> is <code>true</code> if <code>cidr_or_ip</code> (e.g. <code>127.0.0.64/26</code> or <code>127.0.0.1</code>) is contained within <code>cidr</code> (e.g. <code>127.0.0.1/24</code>) and false otherwise. Supports both IPv4 and IPv6 notations.</td></tr><tr><td><span class=opa-keep-it-together><code>net.cidr_intersects(cidr1, cidr2)</code></span></td><td><code>output</code> is <code>true</code> if <code>cidr1</code> (e.g. <code>192.168.0.0/16</code>) overlaps with <code>cidr2</code> (e.g. <code>192.168.1.0/24</code>) and false otherwise. Supports both IPv4 and IPv6 notations.</td></tr></tbody></table><h3 id=rego>Rego</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := rego.parse_module(filename, string)</code></span></td><td><code>rego.parse_module</code> parses the input <code>string</code> as a Rego module and returns the AST as a JSON object <code>output</code>.</td></tr></tbody></table><h3 id=opa>OPA</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>output := opa.runtime()</code></span></td><td><code>opa.runtime</code> returns a JSON object <code>output</code> that describes the runtime environment where OPA is deployed. <strong>Caution</strong>: Policies that depend on the output of <code>opa.runtime</code> may return different answers depending on how OPA was started. If possible, prefer using an explicit <code>input</code> or <code>data</code> value instead of <code>opa.runtime</code>. The <code>output</code> of <code>opa.runtime</code> will include a <code>&quot;config&quot;</code> key if OPA was started with a configuration file. The <code>output</code> of <code>opa.runtime</code> will include a <code>&quot;env&quot;</code> key containing the environment variables that the OPA process was started with.</td></tr></tbody></table><h3 id=debugging>Debugging</h3><table><thead><tr><th>Built-in</th><th>Description</th></tr></thead><tbody><tr><td><span class=opa-keep-it-together><code>trace(string)</code></span></td><td><code>trace</code> outputs the debug message <code>string</code> as a <code>Note</code> event in the query explanation. For example, <code>trace(&quot;Hello There!&quot;)</code> includes <code>Note &quot;Hello There!&quot;</code> in the query explanation. To print variables, use sprintf. For example, <code>person := &quot;Bob&quot;; trace(sprintf(&quot;Hello There! %v&quot;, [person]))</code> will emit <code>Note &quot;Hello There! Bob&quot;</code>.</td></tr></tbody></table><h2 id=reserved-names>Reserved Names</h2><p>The following words are reserved and cannot be used as variable names, rule
names, or dot-access style reference arguments:</p><pre><code>as
default
else
false
import
package
not
null
true
with
</code></pre><h2 id=grammar>Grammar</h2><p>Rego’s syntax is defined by the following grammar:</p><pre><code>module          = package { import } policy
package         = &quot;package&quot; ref
import          = &quot;import&quot; package [ &quot;as&quot; var ]
policy          = { rule }
rule            = [ &quot;default&quot; ] rule-head { rule-body }
rule-head       = var [ &quot;(&quot; rule-args &quot;)&quot; ] [ &quot;[&quot; term &quot;]&quot; ] [ = term ]
rule-args       = term { &quot;,&quot; term }
rule-body       = [ else [ = term ] ] &quot;{&quot; query &quot;}&quot;
query           = literal { &quot;;&quot; | [\r\n] literal }
literal         = ( expr | &quot;not&quot; expr ) { with-modifier }
with-modifier   = &quot;with&quot; term &quot;as&quot; term
expr            = term | expr-built-in | expr-infix
expr-built-in   = var [ &quot;.&quot; var ] &quot;(&quot; [ term { , term } ] &quot;)&quot;
expr-infix      = [ term &quot;=&quot; ] term infix-operator term
term            = ref | var | scalar | array | object | set | array-compr | object-compr | set-compr
array-compr     = &quot;[&quot; term &quot;|&quot; rule-body &quot;]&quot;
set-compr       = &quot;{&quot; term &quot;|&quot; rule-body &quot;}&quot;
object-compr    = &quot;{&quot; object-item &quot;|&quot; rule-body &quot;}&quot;
infix-operator  = bool-operator | arith-operator | bin-operator
bool-operator   = &quot;=&quot; | &quot;!=&quot; | &quot;&lt;&quot; | &quot;&gt;&quot; | &quot;&gt;=&quot; | &quot;&lt;=&quot;
arith-operator  = &quot;+&quot; | &quot;-&quot; | &quot;*&quot; | &quot;/&quot;
bin-operator    = &quot;&amp;&quot; | &quot;|&quot;
ref             = var { ref-arg }
ref-arg         = ref-arg-dot | ref-arg-brack
ref-arg-brack   = &quot;[&quot; ( scalar | var | array | object | set | &quot;_&quot; ) &quot;]&quot;
ref-arg-dot     = &quot;.&quot; var
var             = ( ALPHA | &quot;_&quot; ) { ALPHA | DIGIT | &quot;_&quot; }
scalar          = string | NUMBER | TRUE | FALSE | NULL
string          = STRING | raw-string
raw-string      = &quot;`&quot; { CHAR-&quot;`&quot; } &quot;`&quot;
array           = &quot;[&quot; term { &quot;,&quot; term } &quot;]&quot;
object          = &quot;{&quot; object-item { &quot;,&quot; object-item } &quot;}&quot;
object-item     = ( scalar | ref | var ) &quot;:&quot; term
set             = empty-set | non-empty-set
non-empty-set   = &quot;{&quot; term { &quot;,&quot; term } &quot;}&quot;
empty-set       = &quot;set(&quot; &quot;)&quot;
</code></pre><p>The grammar defined above makes use of the following syntax. See <a href=https://en.wikipedia.org/wiki/Extended_Backus–Naur_Form>the Wikipedia page on EBNF</a> for more details:</p><pre><code>[]     optional (zero or one instances)
{}     repetition (zero or more instances)
|      alternation (one of the instances)
()     grouping (order of expansion)
STRING JSON string
NUMBER JSON number
TRUE   JSON true
FALSE  JSON false
NULL   JSON null
CHAR   Unicode character
ALPHA  ASCII characters A-Z and a-z
DIGIT  ASCII characters 0-9
</code></pre></div></section></div></article></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js></script><script src=/js/app.145c7a3bc61d0b561cc282851776ffdcd33e6b35aebca1b05449aa9195eaf751.js integrity="sha256-FFx6O8YdC1YcwoKFF3b/3NM&#43;azWuvKGwVEmqkZXq91E="></script></body></html>