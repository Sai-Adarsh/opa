<!doctype html><html lang=en><head><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-84550302-1','auto');ga('send','pageview');</script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=description content="Policy-based control for cloud native environments"><meta property=og:title content="Rego Cheatsheet"><meta property=og:type content=documentation><meta property=og:url content=https://openpolicyagent.org/docs/v0.10.7/rego-cheatsheet/><meta property=og:locale content=en_US><meta property=og:site_name content="Open Policy Agent"><meta property=og:description content="Policy-based control for cloud native environments"><meta name=og:type content=article><meta name=og:image content=https://openpolicyagent.org/img/logos/opa-horizontal-color.png><meta name=og:image:alt content="Open Policy Agent project logo"><meta name=og:image:type content=image/png><meta name=twitter:card content=summary><meta name=twitter:site content=@OpenPolicyAgent><meta name=twitter:creator content=@OpenPolicyAgent><link rel=canonical content=https://openpolicyagent.org/docs/v0.10.7/rego-cheatsheet/><link rel="shortcut icon" href=/favicon.png type=image/x-icon><meta name=generator content="Hugo 0.53"><title>Open Policy Agent | Rego Cheatsheet</title><link rel=stylesheet href=/css/style.6bbca25e01250b8412df90aabdfbddb4f7b3b892dd593d933cd29794b98a3373.css integrity="sha256-a7yiXgElC4QS35CqvfvdtPezuJLdWT2TPNKXlLmKM3M="></head><body><div class=dashboard><div class="dashboard-panel left has-background-white-bis is-hidden-mobile"><div class="dashboard-panel-header has-text-centered"><div class=dashboard-panel-header-logo><a href=https://openpolicyagent.org><img src=/img/logos/opa-stacked-color.png></a></div><div class="dropdown is-left"><div class=dropdown-trigger><span class="button is-primary"><span><strong>v0.10.7</strong>
<span class="tag latest-tag is-success is-small has-text-weight-bold">latest</span></span></span></div></div></div><div class="dashboard-panel-content is-scrollable"><div class=docs-nav><span class=docs-nav-title>Documentation</span>
<a class=docs-nav-item href=/docs/v0.10.7/>Introduction</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=docs-nav-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class=docs-nav-item href=/docs/v0.10.7/language-reference/>Language Reference</a>
<a class=docs-nav-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=docs-nav-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=docs-nav-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=docs-nav-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=docs-nav-item href=/docs/v0.10.7/status/>Status</a>
<a class=docs-nav-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=docs-nav-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=docs-nav-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=docs-nav-item href=/docs/v0.10.7/security/>Security</a>
<a class=docs-nav-item href=/docs/v0.10.7/plugins/>Plugins</a>
<a class=docs-nav-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=docs-nav-item href=/docs/v0.10.7/faq/>FAQ</a>
<a class="docs-nav-item is-active" href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><div class=toc><nav id=TableOfContents><ul><li><ul><li><a href=#equality>Equality</a></li><li><a href=#lookup>Lookup</a></li><li><a href=#basic-iteration>Basic Iteration</a></li><li><a href=#advanced-iteration>Advanced Iteration</a></li><li><a href=#rule-heads>Rule heads</a></li><li><a href=#testing>Testing</a></li></ul></li></ul></nav></div><hr class=docs-nav-hr><span class=docs-nav-title>Tutorials</span>
<a class=docs-nav-item href=/docs/v0.10.7/get-started/>Get started</a>
<a class=docs-nav-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=docs-nav-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=docs-nav-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=docs-nav-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><hr class=docs-nav-hr><span class=docs-nav-title>Guides</span>
<a class=docs-nav-item href=/docs/v0.10.7/guides-identity/>Identity and User Attributes</a>
<a class=docs-nav-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Kubernetes Admission Control</a></div></div></div><div class="dashboard-main is-scrollable"><nav class="navbar is-primary"><div class="navbar-brand is-hidden-tablet"><a class=navbar-item href=https://openpolicyagent.org><img src=/img/logos/opa-icon-white.png></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=mobile-menu><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div class="navbar-menu is-hidden-tablet" id=mobile-menu><div class=navbar-start><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Documentation</span>
<a class=navbar-item href=/docs/v0.10.7/>Introduction</a>
<a class=navbar-item href=/docs/v0.10.7/how-does-opa-work/>How Does OPA Work?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-write-policies/>How Do I Write Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/how-do-i-test-policies/>How Do I Test Policies?</a>
<a class=navbar-item href=/docs/v0.10.7/language-reference/>Language Reference</a>
<a class=navbar-item href=/docs/v0.10.7/configuration/>Configuration Reference</a>
<a class=navbar-item href=/docs/v0.10.7/rest-api/>REST API</a>
<a class=navbar-item href=/docs/v0.10.7/deployments/>Deployments</a>
<a class=navbar-item href=/docs/v0.10.7/bundles/>Bundles</a>
<a class=navbar-item href=/docs/v0.10.7/status/>Status</a>
<a class=navbar-item href=/docs/v0.10.7/decision-logs/>Decision Logs</a>
<a class=navbar-item href=/docs/v0.10.7/monitoring/>Monitoring</a>
<a class=navbar-item href=/docs/v0.10.7/discovery/>Discovery</a>
<a class=navbar-item href=/docs/v0.10.7/security/>Security</a>
<a class=navbar-item href=/docs/v0.10.7/plugins/>Plugins (Experimental)</a>
<a class=navbar-item href=/docs/v0.10.7/comparison-to-other-systems/>Comparison to Other Systems</a>
<a class=navbar-item href=/docs/v0.10.7/faq/>Frequently Asked Questions</a>
<a class=navbar-item href=/docs/v0.10.7/rego-cheatsheet/>Rego Cheatsheet</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Tutorials</span>
<a class=navbar-item href=/docs/v0.10.7/get-started/>Get started</a>
<a class=navbar-item href=/docs/v0.10.7/docker-authorization/>Docker Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/http-api-authorization/>HTTP API Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/ssh-and-sudo-authorization/>SSH and sudo Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kafka-authorization/>Kafka Authorization</a>
<a class=navbar-item href=/docs/v0.10.7/kubernetes-admission-control/>Kubernetes Admission Control</a>
<a class=navbar-item href=/docs/v0.10.7/terraform/>Terraform Testing</a>
<a class=navbar-item href=/docs/v0.10.7/ceph-authorization/>Ceph Authorization</a><br><span class="navbar-item is-size-5 has-text-weight-light is-uppercase">Guides</span>
<a class=navbar-item href=/docs/v0.10.7/guides-identity/>Guides: Identity and User Attributes</a>
<a class=navbar-item href=/docs/v0.10.7/guides-kubernetes-admission-control/>Guides: Kubernetes Admission Control</a></div><div class=navbar-end><div class=navbar-item><div class=buttons><a class="button is-primary" href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class="button is-primary" href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class="button is-primary" href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class="button is-primary" href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></div></div><div class=navbar-menu><div class=navbar-end><a class=navbar-item href=https://github.com/open-policy-agent/opa target=_blank><span class="icon has-text-white-bis"><i class="fab fa-github"></i></span></a><a class=navbar-item href=https://twitter.com/OpenPolicyAgent target=_blank><span class="icon has-text-white-bis"><i class="fab fa-twitter"></i></span></a><a class=navbar-item href=https://blog.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-medium"></i></span></a><a class=navbar-item href=https://slack.openpolicyagent.org target=_blank><span class="icon has-text-white-bis"><i class="fab fa-slack"></i></span></a></div></div></nav><article class=article><div class=container><section class=hero><div class=hero-body><p class="title is-size-1 is-size-2-mobile">Rego Cheatsheet</p></div></section><section class=section><div class=content><h2 id=equality>Equality</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Outside of a rule, assign variable `whitelist` to the set `hooli.com` and `initech.com`</span>
<span style=color:#000>whitelist</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;hooli.com&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;initech.com&#34;</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Inside of a rule, assign LOCAL variable `x` to the value of label `costcenter`</span>
<span style=color:#000>x</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>input</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>metadata</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>labels</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>costcenter</span>
<span style=color:#8f5902;font-style:italic># Check if variable `x` and `y` have the same value</span>
<span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>y</span>
<span style=color:#8f5902;font-style:italic># Check if variable `whitelist` has value {&#34;hooli.com&#34;, &#34;initech.com&#34;}</span>
<span style=color:#000>whitelist</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;hooli.com&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;initech.com&#34;</span><span style=color:#000;font-weight:700>}</span>
    <span style=color:#8f5902;font-style:italic># OR</span>
<span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;hooli.com&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;initech.com&#34;</span><span style=color:#000;font-weight:700>}</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>whitelist</span></code></pre></div><h2 id=lookup>Lookup</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Array: lookup value at index 0</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Array: lookup all indexes with value &#34;foo&#34;</span>
<span style=color:#4e9a06>&#34;foo&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Array: check if index 0 has value &#34;foo&#34;</span>
<span style=color:#4e9a06>&#34;foo&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Array: last element</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>count</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>arr</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>]</span>

<span style=color:#8f5902;font-style:italic># Object: lookup value for key &#34;foo&#34;</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Object: lookup keys for value &#34;bar&#34;</span>
<span style=color:#4e9a06>&#34;bar&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Object: check if key &#34;foo&#34; has value &#34;bar&#34;</span>
<span style=color:#4e9a06>&#34;bar&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>  <span style=color:#000>OR</span>  <span style=color:#4e9a06>&#34;bar&#34;</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>foo</span>
<span style=color:#8f5902;font-style:italic># Object: check if key &#34;foo&#34; exists</span>
<span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>foo</span>
<span style=color:#8f5902;font-style:italic># Object: check if key assigned to variable k exists</span>
<span style=color:#000>k</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;foo&#34;</span>
<span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Object: check if path foo.bar.baz exists</span>
<span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>baz</span>
<span style=color:#8f5902;font-style:italic># Object: check if path foo.bar.baz, foo.bar, or foo does NOT exist</span>
<span style=color:#204a87;font-weight:700>not</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>baz</span>

<span style=color:#8f5902;font-style:italic># Set: check if &#34;foo&#34; belongs to the set</span>
<span style=color:#000>sett</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Set: check if [1,2,3] belongs to the set</span>
<span style=color:#000>sett</span><span style=color:#ce5c00;font-weight:700>[[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#ce5c00;font-weight:700>]]</span>
<span style=color:#8f5902;font-style:italic># Set: find all arrays of the form [x,2,x] in the set</span>
<span style=color:#000>sett</span><span style=color:#ce5c00;font-weight:700>[[</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>]]</span></code></pre></div><h2 id=basic-iteration>Basic Iteration</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Arrays: iterate over indexes</span>
<span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Arrays: iterate over values</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Arrays: iterate over index/value pairs</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>arr</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Objects: iterate over keys</span>
<span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Objects: iterate over values</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>_</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Objects: iterate over key/value pairs</span>
<span style=color:#000>val</span> <span style=color:#000;font-weight:700>:</span><span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>obj</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Sets: iterate over values</span>
<span style=color:#000>sett</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>val</span><span style=color:#ce5c00;font-weight:700>]</span></code></pre></div><h2 id=advanced-iteration>Advanced Iteration</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Nested iteration: Find key k whose bar.baz array index i is 7</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>baz</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>7</span>
<span style=color:#8f5902;font-style:italic># Simultaneous iteration: Find keys in 2 objects with same value</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k1</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k2</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Simultaneous self iteration: find 2 keys with same value in 1 obj</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k1</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k2</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Simultaneous, nested iteration</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k1</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i1</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k2</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>baz</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i2</span><span style=color:#ce5c00;font-weight:700>][</span><span style=color:#000>j2</span><span style=color:#ce5c00;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Multi-condition: k has same value in both conditions</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>bar</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>baz</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>7</span>
<span style=color:#000>foo</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>k</span><span style=color:#ce5c00;font-weight:700>].</span><span style=color:#000>qux</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>3</span></code></pre></div><h2 id=rule-heads>Rule heads</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Constant:</span>
<span style=color:#000>foo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#000>bar</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>6</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Constant: derived</span>
<span style=color:#000>baz</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>foo</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#000>bar</span>
<span style=color:#8f5902;font-style:italic># Constant: conditional</span>
<span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>4</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition1</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>57</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition2</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>60</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition3</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Constant: conditional boolean</span>
<span style=color:#204a87>p</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>  <span style=color:#000>OR</span>  <span style=color:#204a87>p</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Function: conditional</span>
<span style=color:#204a87>p</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;A&#34;</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#0000cf;font-weight:700>90</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87>p</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;B&#34;</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#0000cf;font-weight:700>80</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>90</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87>p</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;C&#34;</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#0000cf;font-weight:700>70</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#0000cf;font-weight:700>80</span><span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Function: boolean</span>
<span style=color:#204a87>p</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>  <span style=color:#000>OR</span> <span style=color:#204a87>p</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Set: comprehension</span>
<span style=color:#204a87>p</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Set: partial</span>
<span style=color:#204a87>p</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition1</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87>p</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>y</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition2</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Object: comprehension</span>
<span style=color:#204a87>p</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>x</span><span style=color:#000;font-weight:700>:</span><span style=color:#000>y</span> <span style=color:#ce5c00;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># Object: partial</span>
<span style=color:#204a87>p</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>y</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition1</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#204a87>p</span><span style=color:#ce5c00;font-weight:700>[</span><span style=color:#000>w</span><span style=color:#ce5c00;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>z</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>condition2</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000;font-weight:700>}</span></code></pre></div><h2 id=testing>Testing</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#8f5902;font-style:italic># Create a test</span>
<span style=color:#000>test_NAME</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#ce5c00;font-weight:700>...</span> <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic># evaluate `deny` within package `abc.def`</span>
<span style=color:#8f5902;font-style:italic>#    using `{&#34;foo&#34;: &#34;bar&#34;}` for input</span>
<span style=color:#000>data</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>abc</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>def</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>deny</span> <span style=color:#000>with</span> <span style=color:#000>input</span> <span style=color:#000>as</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;bar&#34;</span><span style=color:#000;font-weight:700>}</span></code></pre></div></div></section></div></article></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js></script><script src=/js/app.145c7a3bc61d0b561cc282851776ffdcd33e6b35aebca1b05449aa9195eaf751.js integrity="sha256-FFx6O8YdC1YcwoKFF3b/3NM&#43;azWuvKGwVEmqkZXq91E="></script></body></html>